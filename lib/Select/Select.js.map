{"version":3,"sources":["../../src/Select/Select.js"],"names":["KEY_UP","KEY_DOWN","KEY_ENTER","KEY_BACKSPACE","KEY_ESC","WrapperSelect","props","onClearValue","event","preventDefault","stopPropagation","resetField","onSelectValue","newValue","value","state","label","optionsMap","setState","valueLabel","onChange","closeOptions","onValueClick","onSelectFocused","isOpened","isFocused","setFocus","onSearching","focusedIndex","options","setTimeout","filteredOptions","filter","opt","toLowerCase","term","inputInnerRef","indexOf","searchTerm","lastIndex","length","keyCode","reduce","agregate","current","hasOwnProperty","isSelected","focus","onInputClear","placeholder","content","n","onOpen","map","i","e","clearable","name","disabled","renderSelectMultiValueWrapper","renderSelectClearZone","renderSelectMenuOuter","PureComponent","propTypes","any","array","func","bool","string","defaultProps"],"mappings":"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","file":"Select.js","sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport styled from 'styled-components'\nimport enhanceWithClickOutside from 'react-click-outside'\n\nconst KEY_UP = 38\nconst KEY_DOWN = 40\nconst KEY_ENTER = 13\nconst KEY_BACKSPACE = 8\nconst KEY_ESC = 27\n\nimport Select from './partials/Select'\nimport SelectMenu from './partials/SelectMenu'\nimport SelectValue from './partials/SelectValue'\nimport SelectClear from './partials/SelectClear'\nimport SelectArrow from './partials/SelectArrow'\nimport SelectInput from './partials/SelectInput'\nimport SelectInputField from './partials/SelectInputField'\nimport SelectOption from './partials/SelectOption'\nimport SelectControl from './partials/SelectControl'\nimport SelectClearZone from './partials/SelectClearZone'\nimport SelectArrowZone from './partials/SelectArrowZone'\nimport SelectValueLabel from './partials/SelectValueLabel'\nimport SelectMenuOuter from './partials/SelectMenuOuter'\nimport SelectPlaceholder from './partials/SelectPlaceholder'\nimport SelectMultiValueWrapper from './partials/SelectMultiValueWrapper'\n\nimport stringifyValue from './functions/stringifyValue'\n\nclass WrapperSelect extends React.PureComponent {\n  constructor(props) {\n    super(props)\n\n    this.optionsMap = props.options.reduce((agregate, current) => {\n      agregate[current.value] = current\n      return agregate\n    }, {})\n\n    let valueLabel = null\n    if (props.value && this.optionsMap.hasOwnProperty(props.value)) {\n      valueLabel = this.optionsMap[props.value].label\n    }\n\n    this.state = {\n      isOpened: false,\n      isFocused: false,\n      isSelected: false,\n      value: props.value,\n      valueLabel,\n      searchTerm: null,\n      focusedIndex: 0,\n      options: props.options\n    }\n\n    this.inputInnerRef = null\n  }\n\n  closeOptions() {\n    this.setState({ isOpened: false });\n  }\n\n  setFocus() {\n    setTimeout(() => {\n      this.inputInnerRef && this.inputInnerRef.focus();\n    }, 10);\n  }\n\n  // react-click-outside callback\n  handleClickOutside() {\n    this.closeOptions()\n  }\n\n  resetField() {\n    this.setState({ value: null, searchTerm: null }, () => {\n      this.closeOptions()\n      this.inputInnerRef.value = ''\n      this.props.onInputClear()\n    })\n  }\n\n  onClearValue = (event) => {\n    event.preventDefault()\n    event.stopPropagation()\n    this.resetField();\n  }\n\n  onSelectValue = (newValue, event) => {\n    const { value } = this.state;\n    const label = this.optionsMap[newValue].label;\n    if (value != newValue) {\n      this.setState({\n        value: newValue,\n        valueLabel: label\n      }, () => {\n        this.props.onChange(newValue);\n      })\n    }\n    this.closeOptions()\n    this.props.onValueClick(newValue, event);\n  }\n\n  onSelectFocused = () => {\n    this.setState({\n      isOpened: true,\n      isFocused: true\n    })\n    this.setFocus();\n  }\n\n  onSearching = (event) => {\n    const { focusedIndex, options } = this.state;\n\n    setTimeout(() => {\n      const filteredOptions = this.props.options.filter((opt) => {\n        const label = opt.label.toLowerCase()\n        const term = this.inputInnerRef.value.toLowerCase()\n        return label.indexOf(term) !== -1\n      });\n      this.setState({ searchTerm: this.inputInnerRef.value, options: filteredOptions })\n    }, 1)\n\n    const lastIndex = (options.length - 1)\n    switch (event.keyCode) {\n      case KEY_BACKSPACE: // backspace\n        if (!this.inputInnerRef.value) {\n          this.resetField()\n        }\n      case KEY_UP:\n        this.setState({\n          focusedIndex: (focusedIndex <= 0 ? lastIndex : (focusedIndex - 1))\n        })\n        return;\n      case KEY_DOWN:\n        this.setState({\n          focusedIndex: (focusedIndex >= lastIndex ? 0 : (focusedIndex + 1))\n        })\n        return;\n      case KEY_ENTER:\n        if (!options.length) return;\n        const newValue = options[focusedIndex].value\n        this.onSelectValue(newValue, event)\n        return;\n      case KEY_ESC:\n        this.closeOptions()\n    }\n  }\n\n  renderSelectMultiValueWrapper() {\n    const { placeholder } = this.props\n    const { value, isSelected, valueLabel, searchTerm } = this.state\n\n    let content = '';\n\n    if (value && !searchTerm) {\n      content = (\n        <SelectValue data-select-value>\n          <SelectValueLabel data-select-value-label>{valueLabel}</SelectValueLabel>\n        </SelectValue>\n      );\n    }\n\n    if (!value && !searchTerm) {\n      content = (\n        <SelectPlaceholder data-select-placeholder>{placeholder}</SelectPlaceholder>\n      )\n    }\n\n    return (\n      <SelectMultiValueWrapper data-select-multi-value-wrapper>\n        {content}\n        <SelectInput data-select-input>\n          <SelectInputField\n            data-select-input-search\n            onKeyDown={this.onSearching}\n            innerRef={(n) => this.inputInnerRef = n}\n            role=\"combobox\" type=\"text\" />\n        </SelectInput>\n      </SelectMultiValueWrapper>\n    );\n  }\n\n  renderSelectMenuOuter() {\n    const { onOpen } = this.props;\n    const { value, isOpened, focusedIndex, options } = this.state;\n\n    if (!isOpened) return;\n\n    onOpen()\n\n    return (\n      <SelectMenuOuter data-select-menu-outer>\n        <SelectMenu data-select-menu>\n          {options.map((opt, i) => (\n            <SelectOption\n              key={i}\n              isSelected={value === opt.value}\n              isFocused={focusedIndex === i}\n              role=\"option\"\n              data-select-option={opt.value}\n              onMouseDown={(e) => this.onSelectValue(opt.value, e)}>\n              {opt.label}\n            </SelectOption>\n          ))}\n        </SelectMenu>\n      </SelectMenuOuter>\n    )\n  }\n\n  renderSelectClearZone() {\n    const { clearable } = this.props;\n\n    if (!clearable) return;\n\n    return (\n      <SelectClearZone data-select-clear-zone onMouseDown={this.onClearValue}>\n        <SelectClear data-select-clear>x</SelectClear>\n      </SelectClearZone>\n    );\n  }\n\n  render () {\n    const { name, disabled } = this.props;\n    const { value, isSelected } = this.state;\n    return (\n      <Select data-select>\n        <input type=\"hidden\" name={name} value={stringifyValue(value)} disabled={disabled} />\n        <SelectControl data-select-control onMouseDown={this.onSelectFocused}>\n          {this.renderSelectMultiValueWrapper()}\n          {this.renderSelectClearZone()}\n          <SelectArrowZone data-select-arrow-zone>\n            <SelectArrow data-select-arrow />\n          </SelectArrowZone>\n        </SelectControl>\n        {this.renderSelectMenuOuter()}\n      </Select>\n    )\n  }\n}\n\nWrapperSelect.propTypes = {\n  value: PropTypes.any,\n  options: PropTypes.array,\n  onOpen: PropTypes.func,\n  onChange: PropTypes.func,\n  onValueClick: PropTypes.func,\n  onInputClear: PropTypes.func,\n  clearable: PropTypes.bool,\n  placeholder: PropTypes.string\n}\n\nWrapperSelect.defaultProps = {\n  onOpen: () => {},\n  onChange: () => {},\n  onValueClick: () => {},\n  onInputClear: () => {},\n  clearable: true,\n  options: [],\n  placeholder: 'Select...'\n}\n\nexport default enhanceWithClickOutside(WrapperSelect)\n"]}